
---
- hosts: localhost
  pre_tasks:
  - name: apt update
    apt: update_cache=yes
    changed_when: False
    ignore_errors: True
    when: ansible_os_family == 'Debian'
  roles:
    - role_under_test
  post_tasks:
    - name: Check Working URI
      uri:
        url: http://www.google.com
        force_basic_auth: yes
        return_content: yes
        status_code: 200
        follow_redirects: all
      register: __jenkins_webpage
    - name: Debug Webpage
      debug: var=__jenkins_webpage

    - name: Check if MySQL is running
      service:
        name: mysql
        state: started
      register: service_mysql_status

    - name: Report status of MySQL
      debug: var=service_mysql_status
